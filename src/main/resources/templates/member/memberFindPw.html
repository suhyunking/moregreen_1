
<!DOCTYPE html>
<html xmlns:th="http://www.thymleaf.org">
<head>
<meta charset="utf-8" />
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="apple-touch-icon" sizes="76x76" th:href="@{/img/apple-icon.png}">
<link rel="icon" type="image/png" th:href="@{/img/moregreen.ico}">
<title>비밀번호찾기</title>
<!--     Fonts and icons     -->
<link rel="stylesheet" type="text/css"
	href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900|Roboto+Slab:400,700" />
<!-- Nucleo Icons -->
<link th:href="@{/css/nucleo-icons.css}" rel="stylesheet" />
<link th:href="@{/css/nucleo-svg.css}" rel="stylesheet" />
<!-- Font Awesome Icons -->
<script src="https://kit.fontawesome.com/42d5adcbca.js"
	crossorigin="anonymous"></script>
<!-- Material Icons -->
<link
	href="https://fonts.googleapis.com/icon?family=Material+Icons+Round"
	rel="stylesheet">
<!-- CSS Files -->
<link id="pagestyle" th:href="@{/css/material-dashboard.css?v=3.0.4}"
	rel="stylesheet" />
<style>
/* #overlappedID{:} */
.olmessagef {
	color: red;
	font-style: Italic;
}

.olmessaget {
	color: blue;
	font-style: Italic;
}
</style>
<script src="../js/jquery-3.6.0.js"></script>
<script src="../js/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function(){
	$('#checkEmail').on('click', function(){
		event.preventDefault()
    	checkEmail();
	});
	
	
	function checkEmail(){
		
	    const m_id = $('#m_id').val();
	    const m_email = $('#m_email').val();
	    if(!m_id || m_id.trim() === ""){
	        alert("아이디를 입력하세요.");
	      
	    } if(!m_email || m_email.trim() === ""){
	        alert("이메일을 입력하세요.");
	      
	    }
	    else {
	        $.ajax({
	        	url: '/member/findPw',
	            type: 'POST',
	            contentType: 'application/json;charset=utf-8',	            
	            data: JSON.stringify({
	            	m_id: m_id,
	                m_email: m_email
	            }),
	            dataType: "json",
	            success: function (result) {
		            if (result == "1") {
		                sendEmail();
		                 alert('임시비밀번호를 전송 했습니다.'); 
		                 window.location.href=[[@{'/member/memberLogin'}]]; 
		            } else if (result != "1") {
		                alert('가입되지 않은 이메일입니다.');
		            }	            
		        },
	            fail: function() {
	            	
	            	alert(JSON.stringify(error));
	            }	        
	   	 	});
		 }
	}

	function sendEmail(){
		const m_id = $('#m_id').val();
	    const m_email = $('#m_email').val();
	    $.ajax({
	    	url: '/member/sendPwd',
	        type: 'POST',
	        contentType: 'application/json;charset=utf-8',
	        data: JSON.stringify({
	            m_id: m_id,
	            m_email : m_email
	        }),
	        dataType: "json",
	        error: function(error){
	            alert("이메일발송에오류가 발생하였습니다.");
	        }
	    })
	}

});


</script>
</head>

<body class="bg-gray-200">
	<div class="container position-sticky z-index-sticky top-0">
		<div class="row">
			<div class="col-12"></div>
		</div>
	</div>
	<main class="main-content  mt-0">
		<div class="page-header align-items-start min-vh-100"
			style="background-color: honeydew;">
			<span class="mask opacity-6"></span>
			<div class="container my-auto">
				<div style="text-align: center;">
					<a th:href="@{/index}"> <img th:src="@{/img/logo/logo1.png}"
						alt="Logo">
					</a>
				</div>
				<div class="row">
					<div class="col-lg-4 col-md-8 col-12 mx-auto">
						<div class="card z-index-0 fadeIn3 fadeInBottom">
							<div
								class="card-header p-0 position-relative mt-n4 mx-3 z-index-2">
								<div class="bg-gradient-primary border-radius-lg py-3 pe-1">
									<h4 class="text-white font-weight-bolder text-center mt-2 mb-0">비밀번호찾기</h4>
								</div>
							</div>
							<div class="card-body">
								<form method="POST" role="form" name="sendEmail" class="text-start" th:action="@{/member/sendPwd}">
									<p class="mt-4 text-sm text-center">비밀번호 찾기는 링크를 전송해드립니다.
									<div class="input-group input-group-outline my-3">
										<input type="text" name="m_id" id="m_id"placeholder="아이디"
											class="form-control">
									</div>
									<div class="input-group input-group-outline mb-3">

										<input type="email" id="m_email" name="m_email" placeholder="이메일"
											class="form-control">
									</div>
									<div class="text-center">
										<button type="button" id="checkEmail" th:action="@{/memberLogin}"
											class="btn bg-gradient-primary w-100 my-4 mb-2">OK</button>
									</div>
									<p class="mt-4 text-sm text-center">
										계정이 없으신가요? <a th:href="@{/memberReg}"
											class="text-primary text-gradient font-weight-bold">가입하기</a>
									</p>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</main>
	<!--   Core JS Files   -->
	<script th:src="@{/js/core/popper.min.js}"></script>
	<script th:src="@{/js/core/bootstrap.min.js}"></script>
	<script th:src="@{/js/plugins/perfect-scrollbar.min.js}"></script>
	<script th:src="@{/js/plugins/smooth-scrollbar.min.js}"></script>
	<script>
    var win = navigator.platform.indexOf('Win') > -1;
    if (win && document.querySelector('#sidenav-scrollbar')) {
      var options = {
        damping: '0.5'
      }
      Scrollbar.init(document.querySelector('#sidenav-scrollbar'), options);
    }
  </script>
	<!-- Github buttons -->
	<script async defer src="https://buttons.github.io/buttons.js"></script>
	<!-- Control Center for Material Dashboard: parallax effects, scripts for the example pages etc -->
	<script th:src="@{/js/material-dashboard.min.js?v=3.0.4}"></script>
</body>

</html>